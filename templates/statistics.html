<!DOCTYPE html>
{% extends 'base.html' %}
{% load static %}

{% block content %}
<!-- Navbar -->
{% include 'navbar.html' %}

<div class="container-fluid">
    <h1 class="text-center my-4">Estadísticas</h1>

    <!-- Formulario de filtrado -->
    <div class="card mb-4">
        <div class="card-body">
            <form method="GET" class="row">
                <div class="col-md-4">
                    <label for="fecha_inicio">Fecha Inicio:</label>
                    <input type="date" name="fecha_inicio" class="form-control" id="fecha_inicio">
                </div>
                <div class="col-md-4">
                    <label for="fecha_fin">Fecha Fin:</label>
                    <input type="date" name="fecha_fin" class="form-control" id="fecha_fin">
                </div>
                <div class="col-md-4">
                    <label for="categorias">Categorías:</label>
                    <select name="categorias" class="form-control" id="categorias" multiple>
                        <!-- Ejemplo de categorías dinámicas -->
                        {% for categoria in todas_categorias %}
                        <option value="{{ categoria.id }}">{{ categoria.nombre }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-12 mt-3 text-center">
                    <button type="submit" class="btn" style="background-color: #5F0293; color: white;">Aplicar Filtros</button>
                </div>
                
            </form>
        </div>
    </div>
    <div class="row">
        <!-- Tarjeta de Pasos -->
        <div class="col-md-4 mb-4">
            <div class="card shadow-sm rounded">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h3 class="card-title mb-0">Pasos</h3>
                        <span class="badge" style="background-color: #5F0293;">1000</span>
                    </div>
                    <canvas id="stepsChart" class="w-100" style="height: 280px;"></canvas>
                </div>
            </div>
        </div>

        <!-- Tarjeta de Tomar Agua -->
        <div class="col-md-4 mb-4">
            <div class="card shadow-sm rounded">
                <div class="card-body">
                    <h3 class="card-title mb-0" style="font-family: 'Anta';">Tomar Agua</h3>
                    <canvas id="waterChart" class="w-100" style="height: 300px;"></canvas>
                    <div class="text-start mt-3">
                        <p>Hoy <span class="float-end">2.0L</span></p>
                        <hr>
                        <p>Mejor <span class="float-end">2.5L</span></p>
                        <hr>
                        <p>Promedio <span class="float-end">2.2L</span></p>
                        <hr>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tarjeta de Promedio Diario -->
        <div class="col-md-4 mb-4">
            <div class="card shadow-sm rounded">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <h3 class="text-left" style="color: #FFFFFF;">Promedio Diario</h3>
                        <div class="text-right">
                            <h2>2h 20m</h2>
                            <p style="color: #8E44AD;">+30m esta semana</p>
                        </div>
                    </div>
                    <canvas id="averageChart" class="w-100" style="height: 280px;"></canvas>
                    <div style="display: flex; justify-content: space-around; margin-top: 10px;">
                        <div style="color: #FF464F;">
                            <span style="display:inline-block; width: 10px; height: 10px; background-color: #FF464F; border-radius: 50%;"></span> 2h
                        </div>
                        <div style="color: #1ED36F;">
                            <span style="display:inline-block; width: 10px; height: 10px; background-color: #1ED36F; border-radius: 50%;"></span> 30m
                        </div>
                        <div style="color: #0061F2;">
                            <span style="display:inline-block; width: 10px; height: 10px; background-color: #0061F2; border-radius: 50%;"></span> 5h
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Nueva Tarjeta con Código Sugerido -->
    <div class="card shadow-sm mb-4">
        <div class="card-body">
            <div class="row">
                <div class="col-md-6 text-center">
                    <div class="w-25 mx-auto"> dddd
                        <canvas id="grafico1"></canvas>
                    </div>
                    <p>1,235</p>
                    <p>################</p>
                </div>
                <div class="col-md-6 text-center">
                    <div class="w-25 mx-auto"> ffff
                        <canvas id="grafico2"></canvas>
                    </div>
                    <p>456</p>
                    <p>@@@@@@@@@@@@</p>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-md-6 text-center">
                    <div class="w-25 mx-auto"> yyyy
                        <canvas id="grafico3"></canvas>
                    </div>
                    <p>1,235 <span style="color: purple;">↓</span></p>
                    <p>$$$$$$$$$$$$</p>
                </div>
                <div class="col-md-6 text-center">
                    <div class="w-25 mx-auto"> uuuu
                        <canvas id="grafico4"></canvas>
                    </div>
                    <p>456 <span style="color: yellow;">↑</span></p>
                    <p>%%%%%%%%%%%%</p>
                </div>
            </div>
        </div>
    </div>
    
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var ctxSteps = document.getElementById('stepsChart').getContext('2d');
        var gradientSteps = ctxSteps.createLinearGradient(0, 0, 0, 400);
        gradientSteps.addColorStop(0, 'rgba(255, 99, 132, 1)');   
        gradientSteps.addColorStop(0.1, 'rgba(255, 99, 132, 0.9)');
        gradientSteps.addColorStop(0.2, 'rgba(255, 99, 132, 0.7)');
        gradientSteps.addColorStop(0.3, 'rgba(255, 99, 132, 0.5)');
        gradientSteps.addColorStop(0.5, 'rgba(255, 99, 132, 0.3)'); 
        gradientSteps.addColorStop(0.7, 'rgba(255, 99, 132, 0.2)');
        gradientSteps.addColorStop(0.9, 'rgba(255, 99, 132, 0.1)');
        gradientSteps.addColorStop(1, 'rgba(255, 99, 132, 0)');


        var stepsChart = new Chart(ctxSteps, {
            type: 'line',
            data: {
                labels: ['10', '11', '12', '13', '14', '15'],
                datasets: [{
                    label: 'Pasos',
                    data: [1000, 8000, 9500, 7000, 6000, 7500],
                    borderColor: '#FF464F',
                    borderWidth: 2,
                    fill: true,
                    backgroundColor: gradientSteps,
                    pointRadius: 0,
                    pointHoverRadius: 8,
                    pointHoverBorderColor: '#FF464F',
                    pointHoverBackgroundColor: 'white'
                }]
            },
            options: {
                elements: {
                    point: {
                        radius: function(context) {
                            return context.dataIndex === 2 ? 10 : 0;
                        },
                        backgroundColor: function(context) {
                            return context.dataIndex === 2 ? '#FF464F' : 'rgba(255, 99, 132, 0)';
                        },
                        borderColor: function(context) {
                            return context.dataIndex === 2 ? '#FFFFFF' : '#FF464F';
                        },
                        borderWidth: 5,
                    },
                    line: {
                        tension: 0.4
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(tooltipItem) {
                                return 'Pasos: ' + tooltipItem.raw;
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        grid: {
                            borderDash: [5, 5],
                            color: 'rgba(0, 0, 0, 0.1)'
                        },
                        ticks: {
                            font: {
                                family: 'Anta',
                                size: 12
                            }
                        }
                    },
                    y: {
                        display: false
                    }
                },
                hover: {
                    mode: 'nearest',
                    intersect: true
                },
                interaction: {
                    mode: 'nearest',
                    axis: 'x',
                    intersect: false
                }
            }
        });

        // Gráfico de tomar agua
        var ctxWater = document.getElementById('waterChart').getContext('2d');
        var waterChart = new Chart(ctxWater, {
            type: 'bar',
            data: {
                labels: ['L', 'M', 'M', 'J', 'V', 'S', 'D'],
                datasets: [{
                    label: 'Litros de Agua',
                    data: [2.0, 2.1, 2.3, 2.0, 2.4, 2.5, 2.2],
                    backgroundColor: '#FF464F',
                    borderWidth: 1,
                    borderRadius: 10,
                    borderSkipped: false,
                    barThickness: 20
                }]
            },
            options: {
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    x: {
                        grid: {
                            display: false
                        },
                        ticks: {
                            color: '#A9A9A9',
                            font: {
                                size: 14,
                                family: 'Anta'
                            }
                        }
                    },
                    y: {
                        beginAtZero: true,
                        max: 3,
                        ticks: {
                            display: false
                        },
                        grid: {
                            color: '#E0E0E0',
                            borderDash: [5, 5],
                            drawBorder: false
                        }
                    }
                }
            }
        });

        // Gráfico de promedio diario
        var ctxAverage = document.getElementById('averageChart').getContext('2d');
        var averageChart = new Chart(ctxAverage, {
            type: 'bar',
            data: {
                labels: ['L', 'M', 'M', 'J', 'V', 'S', 'D'],
                datasets: [
                    {
                        label: '5h',
                        data: [1, 1, 2, 2, 3, 3, 3],
                        backgroundColor: '#0061F2',
                        borderWidth: 1,
                        barThickness: 20,
                        maxBarThickness: 25
                    },
                    {
                        label: '30m',
                        data: [0.5, 0.3, 0.4, 0.6, 0.4, 0.6, 1.5],
                        backgroundColor: '#1ED36F',
                        borderWidth: 1,
                        barThickness: 20,
                        maxBarThickness: 25
                    },
                    {
                        label: '2h',
                        data: [1, 1.5, 1, 2, 2, 2.5, 2.2],
                        backgroundColor: '#FF464F',
                        borderWidth: 1,
                        borderRadius: {
                            topLeft: 10,
                            topRight: 10
                        },
                        barThickness: 20,
                        maxBarThickness: 25
                    }
                ]
            },
            options: {
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    x: {
                        stacked: true,
                        grid: {
                            display: false
                        },
                        ticks: {
                            color: '#A9A9A9',
                            font: {
                                family: 'Anta',
                                size: 14
                            }
                        }
                    },
                    y: {
                        stacked: true,
                        grid: {
                            color: '#E0E0E0',
                            borderDash: [5, 5],
                            drawBorder: false
                        },
                        ticks: {
                            display: false
                        }
                    }
                }
            }
        });

        // Nuevos Gráficos
        const ctx1 = document.getElementById('grafico1').getContext('2d');
        const grafico1 = new Chart(ctx1, {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: [70, 30],
                    backgroundColor: ['#800080', '#EEEEEE']
                }]
            },
            options: {
                cutout: '70%',
                responsive: true,
                plugins: {
                    legend: { display: false }
                }
            }
        });

        const ctx2 = document.getElementById('grafico2').getContext('2d');
        const grafico2 = new Chart(ctx2, {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: [50, 50],
                    backgroundColor: ['#FFCC00', '#EEEEEE']
                }]
            },
            options: {
                cutout: '70%',
                responsive: true,
                plugins: {
                    legend: { display: false }
                }
            }
        });

        const ctx3 = document.getElementById('grafico3').getContext('2d');
        const grafico3 = new Chart(ctx3, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    data: [10, 20, 15, 25, 30, 40],
                    borderColor: '#800080',
                    tension: 0.4,
                    fill: false,
                    pointRadius: 0,
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: { display: false },
                    y: { display: false }
                }
            }
        });

        const ctx4 = document.getElementById('grafico4').getContext('2d');
        const grafico4 = new Chart(ctx4, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    data: [20, 30, 25, 35, 40, 45],
                    borderColor: '#FFCC00',
                    tension: 0.4,
                    fill: false,
                    pointRadius: 0,
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: { display: false },
                    y: { display: false }
                }
            }
        });
    });
</script>
{% endblock %}
